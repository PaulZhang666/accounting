<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½å¤´å‚é‡å»ºï¼šä¼šè®¡æ¦‚å¿µ</title>
    <!-- PWA Manifest Link -->
    <link rel="manifest" href="manifest.json">
    <!-- å¼•å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* å¯ç”¨ Inter å­—ä½“å’Œè‡ªå®šä¹‰ä¸»é¢˜ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0fdf4; /* Light green background */
        }
        /* è§’è‰²åŠ¨ç”» CSS */
        .character-container {
            transition: transform 0.5s ease-out, opacity 0.5s ease-out;
            position: absolute;
            bottom: 60px; /* è§’è‰²ä½ç½®ä¸Šç§»ï¼Œç»™åº•éƒ¨åŒºåŸŸç•™å‡ºç©ºé—´ */
            z-index: 10;
        }

        /* åˆå§‹éšè—å’Œé€€åœºçŠ¶æ€ */
        #rabbit-container {
            transform: translateX(-150%); /* ç¡®ä¿åˆå§‹ä½ç½®å®Œå…¨åœ¨å·¦ä¾§å±å¹•å¤– */
            opacity: 0;
            left: 0;
        }
        #turtle-container {
            transform: translateX(150%); /* ç¡®ä¿åˆå§‹ä½ç½®å®Œå…¨åœ¨å³ä¾§å±å¹•å¤– */
            opacity: 0;
            right: 0;
        }

        /* è¿›åœºçŠ¶æ€ */
        .enter-left {
            transform: translateX(0) !important;
            opacity: 1 !important;
        }
        .enter-right {
            transform: translateX(0) !important;
            opacity: 1 !important;
        }

        /* é€€åœºçŠ¶æ€ (é‡ç½®åˆ°å±å¹•å¤–) */
        .exit-left {
            transform: translateX(-150%) !important;
            opacity: 0 !important;
        }
        .exit-right {
            transform: translateX(150%) !important;
            opacity: 0 !important;
        }

        /* å¯¹è¯æ¡†æ·¡å…¥æ·¡å‡º */
        #dialogue-box {
            transition: opacity 0.3s ease-in-out;
        }
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #a7f3d0;
            border-radius: 4px;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- ä¸»æ¸¸æˆå®¹å™¨ -->
    <div id="game-container" class="w-full max-w-4xl h-[600px] bg-white shadow-2xl rounded-xl flex flex-col overflow-hidden border-4 border-green-600">

        <!-- é¡¶éƒ¨åœºæ™¯/æ ‡é¢˜ (é«˜åº¦ç¼©å°) -->
        <div id="scene" class="h-2/5 relative bg-gray-800 p-4 text-center flex items-center justify-center text-white">
            <!-- æ ‡é¢˜ä½ç½®ä¸Šç§»ï¼Œä½¿ç”¨ç»å¯¹å®šä½ -->
            <h1 class="absolute top-4 left-1/2 transform -translate-x-1/2 text-2xl font-bold tracking-wider" id="scene-title">è´¢åŠ¡éƒ¨ï¼šé‡å»ºç§©åºçš„èµ·ç‚¹</h1>
            
            <!-- è§’è‰²å®¹å™¨ï¼šå…”å­ï¼ˆå°æ —ï¼‰ -->
            <div id="rabbit-container" class="character-container" style="transform: translateX(-150%); opacity: 0;">
                <div class="w-20 h-20 sm:w-28 sm:h-28 bg-white rounded-full shadow-lg border-4 border-pink-400 flex items-center justify-center text-4xl" title="ç©å®¶è§’è‰²ï¼šå°æ —ï¼ˆå…”å­ï¼‰">
                    ğŸ‡
                </div>
            </div>

            <!-- è§’è‰²å®¹å™¨ï¼šé¾Ÿçˆ· -->
            <div id="turtle-container" class="character-container" style="transform: translateX(150%); opacity: 0;">
                <div class="w-20 h-20 sm:w-28 sm:h-28 bg-white rounded-full shadow-lg border-4 border-green-400 flex items-center justify-center text-4xl" title="æŒ‡å¯¼è§’è‰²ï¼šé¾Ÿçˆ·">
                    ğŸ¢
                </div>
            </div>

            <!-- åœºæ™¯æç¤º -->
            <div id="message-display" class="absolute top-4 right-4 bg-yellow-300 text-gray-800 text-sm py-1 px-4 rounded-full shadow-md">
                ä»»åŠ¡è¿›åº¦ï¼š0%
            </div>
        </div>

        <!-- å¯¹è¯å’Œé€‰é¡¹åŒºåŸŸ (é«˜åº¦å¢åŠ ) -->
        <div class="h-3/5 bg-gray-100 p-4 flex flex-col border-t-2 border-gray-300">
            
            <!-- å¯¹è¯æ¡† -->
            <div id="dialogue-box" class="flex-shrink-0 bg-white p-3 rounded-lg shadow-md border-l-4 border-blue-500 mb-2 opacity-0">
                <p class="font-semibold text-blue-700 mb-1" id="speaker-name">ç³»ç»Ÿ</p>
                <p class="text-gray-800 custom-scrollbar overflow-y-auto max-h-20" id="dialogue-text">ç‚¹å‡»â€œå¼€å§‹æ¸¸æˆâ€æŒ‰é’®å¼€å§‹å‰§æƒ…ã€‚</p>
            </div>

            <!-- é€‰é¡¹æŒ‰é’®åŒºåŸŸ -->
            <div id="options-container" class="flex-grow flex flex-col space-y-3 custom-scrollbar overflow-y-auto">
                <button onclick="startGame()" id="start-button" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-200">
                    å¼€å§‹æ¸¸æˆ
                </button>
            </div>
        </div>

    </div>

    <script>
        // --- 1. æ•°æ®æ¨¡å‹ï¼ˆJSONæ ¼å¼ï¼‰ ---
        const QUESTION_DATA = [
            // å‰§æƒ…å¼€å§‹
            { 
                id: "START", 
                speaker: "ç³»ç»Ÿ", 
                text: "åœºæ™¯ï¼šè´¢åŠ¡éƒ¨ç¯å…‰æ˜æš—ï¼Œå‡­è¯æ•£è½ã€‚ç©å®¶è§’è‰²'å°æ —'ï¼ˆå…”å­ï¼‰å…¥åœºã€‚",
                options: [{ text: "ç»§ç»­", leadsToId: "QZ01_P1" }] 
            },
            // é¾Ÿçˆ·å‡ºåœºå¯¹è¯
            { 
                id: "QZ01_P1", 
                speaker: "é¾Ÿçˆ·", 
                text: "å°æ —ï¼Œä½ ç»ˆäºæ¥äº†ã€‚ç½å¤´å‚çš„â€˜ç»æµè¯­è¨€â€™ç³»ç»Ÿå´©æºƒäº†ã€‚è¦ä¿®å¤å®ƒï¼Œæˆ‘ä»¬å¿…é¡»å…ˆææ‡‚ä»€ä¹ˆæ˜¯â€˜ä¼šè®¡â€™ã€‚æ¥ï¼Œå¸®æˆ‘ç†æ¸…è¿™äº›æœ€åŸºæœ¬çš„æ¦‚å¿µã€‚",
                options: [{ text: "å¥½çš„ï¼Œæˆ‘è¯¥ä»å“ªé‡Œå¼€å§‹ï¼Ÿ", leadsToId: "QZ01_P2" }],
                character: "turtle" // é¾Ÿçˆ·ä»å³è¾¹å‡ºåœº
            },
            // ç©å®¶è§’è‰²å‡ºåœºå¯¹è¯
            { 
                id: "QZ01_P2", 
                speaker: "å°æ —", 
                text: "ï¼ˆçœ‹ç€åœ°ä¸Šçš„å¡ç‰‡ï¼‰é¾Ÿçˆ·ï¼Œè¿™äº›å‘å…‰çš„å¡ç‰‡å°±æ˜¯æˆ‘ä»¬ç†æ¸…æ¦‚å¿µçš„å…³é”®å—ï¼Ÿ",
                options: [{ text: "æ‹¾å–ç¬¬ä¸€å¼ å¡ç‰‡ï¼šã€ä¼šè®¡æ¦‚å¿µã€‘", leadsToId: "QZ01_Q1" }],
                character: "rabbit" // å…”å­ä»å·¦è¾¹å‡ºåœº
            },

            // --- 2. é—®ç­”ç¯èŠ‚Aï¼šä¼šè®¡æ¦‚å¿µæŒ‘æˆ˜ ---
            { 
                id: "QZ01_Q1", 
                speaker: "é¾Ÿçˆ·", 
                text: "æˆ‘ä»¬å¼€å§‹ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šä¼šè®¡ä»¥ï¼ˆ ï¼‰ä¸ºä¸»è¦è®¡é‡å•ä½ï¼Œå¯¹ç»æµæ´»åŠ¨è¿›è¡Œæ ¸ç®—å’Œç›‘ç£ã€‚",
                isQuestion: true,
                options: [
                    { text: "A. å®ç‰©é‡åº¦", leadsToId: "QZ01_Q1_Wrong" },
                    { text: "B. è´§å¸", leadsToId: "QZ01_Q1_Correct" },
                    { text: "C. åŠ³åŠ¨é‡åº¦", leadsToId: "QZ01_Q1_Wrong" },
                    { text: "D. æ—¶é—´é‡åº¦", leadsToId: "QZ01_Q1_Wrong" },
                ],
                character: "turtle"
            },
            // Q1 æ­£ç¡®åé¦ˆ
            { 
                id: "QZ01_Q1_Correct", 
                speaker: "ç³»ç»Ÿ", 
                text: "ã€æ­£ç¡®ã€‘ç§¯åˆ†+10ï¼Œé‡‘å¸+10ã€‚ç½å¤´å‚è§£æï¼šæˆ‘ä»¬å–å‡ºç½å¤´ã€ä¹°å…¥æ¡ƒå­ã€æ”¯ä»˜å·¥èµ„ï¼Œæœ€åç†Šè€æ¿é—®â€œèµšäº†å¤šå°‘é’±â€ï¼Œå¿…é¡»æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½æ¢ç®—æˆâ€œå…ƒâ€æ‰èƒ½å›ç­”ã€‚",
                options: [{ text: "ä¸‹ä¸€é¢˜", leadsToId: "QZ01_Q2" }],
                character: "system" // ç³»ç»Ÿå¯¹è¯æ—¶ï¼Œè§’è‰²é€€åœº
            },
            // Q1 é”™è¯¯åé¦ˆ (ç®€åŒ–å¤„ç†ï¼Œç›´æ¥å›åˆ°ä¸‹ä¸€é¢˜)
            { 
                id: "QZ01_Q1_Wrong", 
                speaker: "é¾Ÿçˆ·", 
                text: "ä¸å¯¹ï¼Œå°æ —ã€‚ä¸“ä¸šè§£æï¼šä¼šè®¡åœ¨è®°å½•å’ŒæŠ¥å‘Šæ—¶ï¼Œä¸»è¦ä»¥è´§å¸ä¸ºç»Ÿä¸€è®¡é‡å•ä½ã€‚è¯·é‡æ–°æ€è€ƒã€‚",
                options: [{ text: "ä¸‹ä¸€é¢˜ï¼ˆçŸ¥è¯†ç‚¹å·²æŒæ¡ï¼‰", leadsToId: "QZ01_Q2" }],
                character: "turtle"
            },

            // Q2
            { 
                id: "QZ01_Q2", 
                speaker: "é¾Ÿçˆ·", 
                text: "ç¬¬äºŒé¢˜ï¼šä¼šè®¡åªèƒ½ä»¥è´§å¸ä½œä¸ºè®¡é‡å•ä½ã€‚ï¼ˆåˆ¤æ–­é¢˜ï¼‰",
                isQuestion: true,
                options: [
                    { text: "æ˜¯", leadsToId: "QZ01_Q2_Wrong" },
                    { text: "å¦", leadsToId: "QZ01_Q2_Correct" },
                ],
                character: "turtle"
            },
            // Q2 æ­£ç¡®åé¦ˆ
            { 
                id: "QZ01_Q2_Correct", 
                speaker: "ç³»ç»Ÿ", 
                text: "ã€æ­£ç¡®ã€‘ç§¯åˆ†+10ï¼Œé‡‘å¸+10ã€‚ä¸“ä¸šè§£æï¼šè´§å¸æ˜¯ä¸»è¦å°ºåº¦ï¼Œä½†å¿…é¡»è¾…ä»¥å®ç‰©ã€å·¥æ—¶ç­‰éè´§å¸ä¿¡æ¯ã€‚",
                options: [{ text: "ä¸‹ä¸€é¢˜", leadsToId: "QZ01_Q3" }],
                character: "system" // ç³»ç»Ÿå¯¹è¯æ—¶ï¼Œè§’è‰²é€€åœº
            },
            // Q2 é”™è¯¯åé¦ˆ
            { 
                id: "QZ01_Q2_Wrong", 
                speaker: "é¾Ÿçˆ·", 
                text: "ä¸å¯¹ã€‚ç½å¤´å‚è§£æï¼šåªçŸ¥é“æœ‰ä»·å€¼5ä¸‡å…ƒçš„æ¡ƒå­ï¼Œä¸çŸ¥é“æ˜¯25å¨ï¼Œæ€ä¹ˆå®‰æ’è¿è¾“ï¼Ÿæ‰€ä»¥è¿˜éœ€è¦å®ç‰©é‡åº¦ã€‚",
                options: [{ text: "ä¸‹ä¸€é¢˜ï¼ˆçŸ¥è¯†ç‚¹å·²æŒæ¡ï¼‰", leadsToId: "QZ01_Q3" }],
                character: "turtle"
            },

            // Q3
            { 
                id: "QZ01_Q3", 
                speaker: "é¾Ÿçˆ·", 
                text: "ç¬¬ä¸‰é¢˜ï¼šä¸‹åˆ—å“ªé¡¹ä¸å±äºä¼šè®¡çš„åŸºæœ¬ç‰¹å¾ï¼Ÿ",
                isQuestion: true,
                options: [
                    { text: "A. ä»¥è´§å¸ä¸ºä¸»è¦è®¡é‡å•ä½", leadsToId: "QZ01_Q3_Wrong" },
                    { text: "B. å‡†ç¡®å®Œæ•´æ€§", leadsToId: "QZ01_Q3_Wrong" },
                    { text: "C. è¿ç»­ç³»ç»Ÿæ€§", leadsToId: "QZ01_Q3_Wrong" },
                    { text: "D. ä»¥é¢„æµ‹ç»æµå‰æ™¯ä¸ºä¸»è¦ç›®çš„", leadsToId: "QZ01_Q3_Correct" },
                ],
                character: "turtle"
            },
            // Q3 æ­£ç¡®åé¦ˆ -> ä»»åŠ¡å®Œæˆ
            { 
                id: "QZ01_Q3_Correct", 
                speaker: "ç³»ç»Ÿ", 
                text: "ã€æ­£ç¡®ã€‘æ­å–œï¼ç§¯åˆ†+10ï¼Œé‡‘å¸+10ã€‚ä¸“ä¸šè§£æï¼šé¢„æµ‹ç»æµå‰æ™¯æ˜¯ä¼šè®¡ä¿¡æ¯çš„åº”ç”¨ï¼ˆæ‹“å±•èŒèƒ½ï¼‰ï¼Œè€Œéå…¶è®°å½•å’ŒæŠ¥å‘Šæ´»åŠ¨æœ¬èº«çš„åŸºæœ¬ç‰¹å¾ã€‚",
                options: [{ text: "ç¬¬ä¸€å¼ å¡ç‰‡ç‚¹äº®ï¼Œè¿›å…¥å‰§æƒ…æ”¶å°¾", leadsToId: "QZ01_END" }],
                character: "system" // ç³»ç»Ÿå¯¹è¯æ—¶ï¼Œè§’è‰²é€€åœº
            },
            // Q3 é”™è¯¯åé¦ˆ
            { 
                id: "QZ01_Q3_Wrong", 
                speaker: "é¾Ÿçˆ·", 
                text: "è¿™æ˜¯ä¼šè®¡çš„åŸºæœ¬ç‰¹å¾ä¹‹ä¸€ï¼â€œé¢„æµ‹â€å±äºç¬¬äºŒæ­¥çš„ç®¡ç†å†³ç­–ã€‚è¯·é‡æ–°é€‰æ‹©ã€‚",
                options: [{ text: "é‡æ–°å°è¯•", leadsToId: "QZ01_Q3" }],
                character: "turtle"
            },

            // --- 3. ä»»åŠ¡æ”¶å°¾ ---
            { 
                id: "QZ01_END", 
                speaker: "é¾Ÿçˆ·", 
                text: "ï¼ˆæ»¡æ„åœ°ï¼‰æ¦‚å¿µå’ŒèŒèƒ½å·²ç†æ¸…ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¥å»å»ºç«‹å·¥å‚è¿è½¬çš„é‚£äº›â€˜æ ¹æœ¬è§„åˆ™â€™â€”â€”ä¼šè®¡å‡è®¾äº†ã€‚",
                options: [{ text: "è·å¾—é“å…·ã€åŒé¢å°ç« ã€‘ï¼Œä»»åŠ¡1å®Œæˆ (è¿›åº¦20%)", leadsToId: "FINAL_SCREEN" }],
                character: "turtle"
            },

            { 
                id: "FINAL_SCREEN", 
                speaker: "ç³»ç»Ÿ", 
                text: "æ­å–œæ‚¨å®Œæˆç¬¬ä¸€èŠ‚â€œä¼šè®¡æ¦‚å¿µã€èŒèƒ½å’Œç›®æ ‡â€ä»»åŠ¡ï¼ä¸‹ä¸€èŠ‚ä»»åŠ¡å³å°†å¼€å¯ã€‚",
                isFinalScreen: true,
                options: [],
                character: "system" // ç»ˆå±€ï¼Œè§’è‰²é€€åœº
            }
        ];

        // --- 2. æ¸¸æˆçŠ¶æ€å’Œå…ƒç´ å¼•ç”¨ ---
        let currentQuestionId = "START";
        let score = 0;
        let gold = 0;
        let storyEvents = {}; 
        let currentCharacter = null; // è¿½è¸ªå½“å‰å±å¹•ä¸Šçš„è§’è‰²ï¼Œç”¨äºé€€åœºé€»è¾‘

        const dialogueBox = document.getElementById('dialogue-box');
        const speakerName = document.getElementById('speaker-name');
        const dialogueText = document.getElementById('dialogue-text');
        const optionsContainer = document.getElementById('options-container');
        const rabbitContainer = document.getElementById('rabbit-container');
        const turtleContainer = document.getElementById('turtle-container');
        const messageDisplay = document.getElementById('message-display');

        /**
         * æŸ¥æ‰¾å½“å‰ ID å¯¹åº”çš„å‰§æƒ…/é—®é¢˜æ•°æ®
         */
        function getCurrentData() {
            return QUESTION_DATA.find(q => q.id === currentQuestionId);
        }

        /**
         * å¼‚æ­¥å‡½æ•°ï¼šæ§åˆ¶è§’è‰²åŠ¨ç”»çš„è¿›åœºå’Œé€€åœº
         * @param {Object} currentData - å½“å‰å‰§æƒ…æ•°æ®
         */
        async function handleCharacterAnimation(currentData) {
            const nextCharacter = currentData.character;
            const animationDuration = 500; // åŠ¨ç”»æ—¶é•¿ (ms)
            let exitNeeded = false;
            let enterNeeded = false;

            // 1. å¤„ç†é€€åœº (å¦‚æœæœ‰ä¸åŒè§’è‰²åœ¨åœºï¼Œæˆ–è€…ä¸‹ä¸€ä¸ªæ˜¯ç³»ç»Ÿå¯¹è¯)
            if (currentCharacter === 'rabbit' && nextCharacter !== 'rabbit') {
                rabbitContainer.classList.remove('enter-left');
                rabbitContainer.classList.add('exit-left');
                exitNeeded = true;
            } else if (currentCharacter === 'turtle' && nextCharacter !== 'turtle') {
                turtleContainer.classList.remove('enter-right');
                turtleContainer.classList.add('exit-right');
                exitNeeded = true;
            }
            
            // å¦‚æœéœ€è¦é€€åœºï¼Œç­‰å¾…åŠ¨ç”»å®Œæˆ
            if (exitNeeded) {
                await new Promise(resolve => setTimeout(resolve, animationDuration));
                currentCharacter = null; // å±å¹•ä¸Šæ²¡æœ‰è§’è‰²äº†
            }

            // 2. å¤„ç†è¿›åœº (å¦‚æœéœ€è¦æ˜¾ç¤ºæ–°è§’è‰²)
            if (nextCharacter === 'rabbit' && currentCharacter !== 'rabbit') {
                rabbitContainer.classList.remove('exit-left');
                rabbitContainer.classList.add('enter-left');
                enterNeeded = true;
            } else if (nextCharacter === 'turtle' && currentCharacter !== 'turtle') {
                turtleContainer.classList.remove('exit-right');
                turtleContainer.classList.add('enter-right');
                enterNeeded = true;
            }

            // å¦‚æœæœ‰æ–°è§’è‰²è¿›åœºï¼Œæ›´æ–°å½“å‰è§’è‰²çŠ¶æ€
            if (enterNeeded) {
                currentCharacter = nextCharacter;
            }
        }

        /**
         * æ¸²æŸ“å½“å‰å‰§æƒ…/é—®é¢˜
         */
        async function renderScene() {
            const data = getCurrentData();
            if (!data) {
                console.error("æ‰¾ä¸åˆ° ID ä¸º " + currentQuestionId + " çš„æ•°æ®");
                return;
            }

            // 1. å¤„ç†è§’è‰²åŠ¨ç”»
            await handleCharacterAnimation(data);

            // 2. æ›´æ–°å¯¹è¯æ¡†å†…å®¹ (æ·¡å…¥æ•ˆæœ)
            dialogueBox.classList.remove('opacity-100');
            dialogueBox.classList.add('opacity-0');
            
            await new Promise(resolve => setTimeout(resolve, 300)); // ç­‰å¾…å¯¹è¯æ¡†æ·¡å‡º

            speakerName.textContent = data.speaker;
            dialogueText.innerHTML = data.text;
            
            // æ ·å¼è°ƒæ•´
            dialogueBox.style.borderColor = (data.speaker === 'é¾Ÿçˆ·') ? '#3b82f6' : (data.speaker === 'å°æ —' ? '#f472b6' : '#9ca3af');
            speakerName.style.color = (data.speaker === 'é¾Ÿçˆ·') ? '#1e40af' : (data.speaker === 'å°æ —' ? '#be185d' : '#4b5563');

            dialogueBox.classList.remove('opacity-0');
            dialogueBox.classList.add('opacity-100');
            
            // 3. æ¸²æŸ“é€‰é¡¹
            optionsContainer.innerHTML = '';
            if (!data.isFinalScreen) {
                data.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option.text;
                    // æ ¹æ®æ˜¯å¦æ˜¯é—®ç­”ç¯èŠ‚è°ƒæ•´æŒ‰é’®é¢œè‰²
                    const buttonColor = data.isQuestion ? 'bg-orange-500 hover:bg-orange-600 border-orange-700' : 'bg-blue-500 hover:bg-blue-600 border-blue-700';
                    button.className = `text-left text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-200 border-b-4 ${buttonColor} hover:border-b-2`;
                    button.onclick = () => handleOptionClick(option.leadsToId);
                    optionsContainer.appendChild(button);
                });
            } else {
                 const finalMessage = document.createElement('p');
                 finalMessage.textContent = "æ¸¸æˆç»“æŸï¼Œæ„Ÿè°¢ä½“éªŒï¼";
                 finalMessage.className = "text-center text-xl text-gray-600 p-4 bg-gray-200 rounded-lg";
                 optionsContainer.appendChild(finalMessage);
            }
        }

        /**
         * å¤„ç†é€‰é¡¹ç‚¹å‡»
         * @param {string} leadsToId - ä¸‹ä¸€ä¸ªå‰§æƒ…çš„ ID
         */
        function handleOptionClick(leadsToId) {
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å¾—åˆ†ã€æ—¥å¿—è®°å½•ç­‰é€»è¾‘
            if (leadsToId.includes('Correct')) {
                score += 10;
                gold += 10;
            }
            
            // æ›´æ–°è¿›åº¦æ¡
            let progress = 0;
            if (leadsToId === 'QZ01_END') {
                progress = 100;
            } else if (leadsToId === 'QZ01_Q3_Correct') {
                progress = 60;
            } else if (leadsToId === 'QZ01_Q2_Correct') {
                progress = 40;
            } else if (leadsToId === 'QZ01_Q1_Correct') {
                progress = 20;
            }
            messageDisplay.textContent = `å¾—åˆ†: ${score}, é‡‘å¸: ${gold} | ä»»åŠ¡è¿›åº¦ï¼š${progress}%`;
            
            currentQuestionId = leadsToId;
            renderScene();
        }

        /**
         * æ¸¸æˆå¯åŠ¨å‡½æ•°
         */
        function startGame() {
            document.getElementById('start-button').remove();
            currentQuestionId = "START";
            score = 0;
            gold = 0;
            messageDisplay.textContent = "å¾—åˆ†: 0, é‡‘å¸: 0 | ä»»åŠ¡è¿›åº¦ï¼š0%";
            renderScene();
        }

        // é¦–æ¬¡åŠ è½½æ—¶æ˜¾ç¤ºå¯¹è¯æ¡† (åˆå§‹çŠ¶æ€)
        window.onload = () => {
             dialogueBox.classList.add('opacity-100');
        }
    </script>

</body>
</html>